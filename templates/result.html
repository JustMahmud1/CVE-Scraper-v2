{% extends "layout.html" %}

{% block title %}Results for {{ cve_id }}{% endblock %}

{% block content %}
    <div class="container-fluid pt-4 px-4">
        <div class="row justify-content-center">
            <div class="col-lg-8 col-md-10 col-sm-12">
                <div class="bg-secondary rounded p-4">
                    <h1 class="text-center mb-4">Results for {{ cve_id }}</h1>

                    <div class="cve-summary mb-4">
                        <h2>Summary</h2>
                        <p><strong>Description:</strong> {{ description }}</p>
                        <p><strong>CVSS Score:</strong> 
                            <span class="badge bg-warning text-dark">{{ score }}</span>
                        </p>
                        <p><strong>Severity:</strong> 
                            <span class="badge {% if severity == 'HIGH' %} bg-danger {% elif severity == 'MEDIUM' %} bg-warning {% else %} bg-success {% endif %}">{{ severity }}</span>
                        </p>
                    </div>

                    <div class="exploit-links mb-4">
                        <h3>Exploit-DB Links</h3>
                        <ul>
                            <li><a href="https://nvd.nist.gov/vuln/detail/{{ cve_id }}" target="_blank">NIST NVD</a></li>
                            {% if exploit_links %}
                                {% for link in exploit_links %}
                                    <li><a href="{{ link }}" target="_blank">{{ link }}</a></li>
                                {% endfor %}
                            {% else %}
                                <li>No Exploit-DB links found for this CVE.</li>
                            {% endif %}
                        </ul>
                    </div>
                    

                    <div class="references mb-4">
                        <h3>References</h3>
                        <ul>
                            {% for ref in references %}
                                <li><a href="{{ ref }}" target="_blank">{{ ref }}</a></li>
                            {% endfor %}
                        </ul>
                    </div>

                    <form action="{{ url_for('download_report', cve_id=cve_id) }}" method="POST">
                        <div class="mb-3">
                            <label for="file_type" class="form-label">Choose file type:</label>
                            <select name="file_type" id="file_type" class="form-select">
                                <option value="pdf">PDF</option>
                                <option value="docx">DOCX</option>
                            </select>
                        </div>
                        <button type="submit" class="btn btn-primary">Download Report</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
{% endblock %}
