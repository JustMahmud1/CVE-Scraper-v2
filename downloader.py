from fpdf import FPDF
from docx import Document

def generate_report(cve_id, summary, file_type='pdf'):
    if file_type == 'pdf':
        return generate_pdf_report(cve_id, summary)
    elif file_type == 'docx':
        return generate_docx_report(cve_id, summary)
    # Add more formats as needed

def generate_pdf_report(cve_id, summary):
    pdf = FPDF()
    pdf.add_page()
    pdf.set_font("Arial", size=12)
    
    pdf.cell(200, 10, txt=f"CVE Report: {cve_id}", ln=True, align='C')
    pdf.multi_cell(0, 10, txt=summary)
    
    file_path = f"{cve_id}.pdf"
    pdf.output(file_path)
    return file_path

def generate_docx_report(cve_id, summary):
    doc = Document()
    doc.add_heading(f"CVE Report: {cve_id}", 0)
    
    doc.add_paragraph(summary)
    
    file_path = f"{cve_id}.docx"
    doc.save(file_path)
    return file_path
